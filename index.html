<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Engel Movie Collection</title>
	<link rel="apple-touch-icon" href="assets/favicon-228.png">
	<link rel="icon" type="image/png" href="assets/favicon-228.png">
	<link rel="shortcut icon" href="assets/favicon-228.png">
	<meta name="msapplication-TileColor" content="#0d0e16">
	<meta name="msapplication-TileImage" content="assets/favicon-144.png">
	<meta name="theme-color" content="#0d0e16">
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;900&display=swap" rel="stylesheet">
	<link href="assets/main.min.css" rel="stylesheet">
</head>

<body>
	<div id="movies" v-cloak>

		<h1>
			<template v-if="screenPass">
				<span class="gradient-text">Screen</span> Pass
				<span class="screen-pass-availability" v-if="currentMonth">
					<span class="screen-pass-counter">{{ screenPassCounter }}</span>
					remaining for {{ currentMonth }}
				</span>
			</template>

			<template v-else>
				<span class="gradient-text">Movie</span> Collection
			</template>
		</h1>

		<div v-if="loading" class="loader"></div>

		<h2 v-else-if="errored">Movie data could not be retrieved. Try again later.</h2>

		<template v-else>
			<div class="filters" :class="{ active: panelActive }" >

				<div class="movie-count">
					<h2><span>{{ movies.length}}</span> movies</h2>
				</div> <!-- /movie-count -->
				
				<button type="button" class="filter-btn" @click="toggleFilters" ref="filterPanelBtn">
					<svg class="filter-icon" width="18px" height="18px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
						<path d="M35,4H15.65C14.83,1.67,12.61,0,10,0C7.39,0,5.17,1.67,4.35,4H1C0.45,4,0,4.45,0,5v2c0,0.55,0.45,1,1,1h3.35 c0.82,2.33,3.04,4,5.65,4c2.61,0,4.83-1.67,5.65-4H35c0.55,0,1-0.45,1-1V5C36,4.45,35.55,4,35,4z M10,9C8.34,9,7,7.66,7,6 s1.34-3,3-3c1.66,0,3,1.34,3,3S11.66,9,10,9z" />
						<path d="M35,16h-3.35c-0.82-2.33-3.04-4-5.65-4c-2.61,0-4.83,1.67-5.65,4H1c-0.55,0-1,0.45-1,1v2c0,0.55,0.45,1,1,1h19.35 c0.82,2.33,3.04,4,5.65,4c2.61,0,4.83-1.67,5.65-4H35c0.55,0,1-0.45,1-1v-2C36,16.45,35.55,16,35,16z M26,21c-1.66,0-3-1.34-3-3 s1.34-3,3-3c1.66,0,3,1.34,3,3S27.66,21,26,21z" />
						<path d="M35,28H19.65c-0.82-2.33-3.04-4-5.65-4c-2.61,0-4.83,1.67-5.65,4H1c-0.55,0-1,0.45-1,1v2c0,0.55,0.45,1,1,1h7.35 c0.82,2.33,3.04,4,5.65,4c2.61,0,4.83-1.67,5.65-4H35c0.55,0,1-0.45,1-1v-2C36,28.45,35.55,28,35,28z M14,33c-1.66,0-3-1.34-3-3 s1.34-3,3-3c1.66,0,3,1.34,3,3S15.66,33,14,33z" />
					</svg>
					Filter
				</button>
				
				<div class="filter-panel" :class="{ active: panelActive }" ref="filterPanel">
					<button type="button" class="filter-close-btn" @click="toggleFilters" title="Close">&times;</button>
					
					<div class="filter-option search">
						<input type="search" placeholder="Search by movie title" id="search" v-model.lazy="search" autocomplete="off">
						<svg class="search-icon" width="14px" height="14px" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
							<path d="M13.7,12.3l-3-3c0.7-1,1.1-2.2,1.1-3.5c0-1.6-0.6-3.1-1.7-4.2C9,0.6,7.5,0,5.9,0C4.4,0,2.9,0.6,1.7,1.7 C0.6,2.9,0,4.4,0,5.9S0.6,9,1.7,10.1c1.1,1.1,2.6,1.7,4.2,1.7c1.3,0,2.5-0.4,3.5-1.1l3,3c0.2,0.2,0.4,0.3,0.7,0.3 c0.2,0,0.5-0.1,0.7-0.3C14.1,13.3,14.1,12.7,13.7,12.3z M3.1,8.8C2.4,8,1.9,7,1.9,5.9s0.4-2.1,1.2-2.8c0.8-0.8,1.8-1.2,2.8-1.2 S8,2.4,8.8,3.1c0.8,0.8,1.2,1.8,1.2,2.8S9.5,8,8.8,8.8C8,9.5,7,9.9,5.9,9.9S3.9,9.5,3.1,8.8z"/>
						</svg>
					</div> <!-- /filter-option -->
					
					<template v-for="i in 1">
						<div class="filter-option" :class="{ active: activeFilter === 'sort' }" ref="filterOption">
							<span class="filter-option-title" tabindex="0" @click="selectFilter('sort')" v-on:keyup.enter="selectFilter('sort')">
								Sort
								<svg class="filter-arrow" width="10px" height="7px" viewBox="0 0 10 7" xmlns="http://www.w3.org/2000/svg">
									<path d="M4.47,6.24L0.22,1.99c-0.29-0.29-0.29-0.77,0-1.06l0.71-0.71c0.29-0.29,0.77-0.29,1.06,0L5,3.23l3.01-3.01 c0.29-0.29,0.77-0.29,1.06,0l0.71,0.71c0.29,0.29,0.29,0.77,0,1.06L5.53,6.24C5.24,6.53,4.77,6.53,4.47,6.24L4.47,6.24z"/>
								</svg>
							</span>
							<div class="filter-option-menu">
								<div class="filter-field">
									<input type="radio" id="sort-recent" value="recent" v-model="sort">
									<label for="sort-recent">Recently Added</label>
								</div>
								<div class="filter-field">
									<input type="radio" id="sort-alpha" value="alpha" v-model="sort">
									<label for="sort-alpha">A-Z</label>
								</div>
							</div> <!-- /filter-option-menu -->
						</div> <!-- /filter-option -->

						<div class="filter-option" :class="{ active: activeFilter === 'format', 'has-selections' : formatFilter.length > 0 }" v-if="!screenPass" ref="filterOption">
							<span class="filter-option-title" tabindex="0" @click="selectFilter('format')" v-on:keyup.enter="selectFilter('format')">
								Format &amp; Quality
								<svg class="filter-arrow" width="10px" height="7px" viewBox="0 0 10 7" xmlns="http://www.w3.org/2000/svg">
									<path d="M4.47,6.24L0.22,1.99c-0.29-0.29-0.29-0.77,0-1.06l0.71-0.71c0.29-0.29,0.77-0.29,1.06,0L5,3.23l3.01-3.01 c0.29-0.29,0.77-0.29,1.06,0l0.71,0.71c0.29,0.29,0.29,0.77,0,1.06L5.53,6.24C5.24,6.53,4.77,6.53,4.47,6.24L4.47,6.24z"/>
								</svg>
							</span>
							<div class="filter-option-menu">
								<span class="filter-option-cat">Digital</span>
								<div class="filter-field" v-for="(digitalFormat, index) in digitalFormats">
									<input type="checkbox" :id="'digital-' + index" :value="digitalFormat" v-model="formatFilter">
									<label :for="'digital-' + index">{{ digitalFormat }}</label>
								</div>
								<span class="filter-option-cat">Physical</span>
								<div class="filter-field" v-for="(physicalFormat, index) in physicalFormats">
									<input type="checkbox" :id="'physical-' + index" :value="physicalFormat" v-model="formatFilter">
									<label :for="'physical-' + index">{{ physicalFormat }}</label>
								</div>
							</div> <!-- /filter-option-menu -->
						</div> <!-- /filter-option -->

						<div class="filter-option" :class="{ active: activeFilter === 'genre', 'has-selections' : genreFilter.length > 0 }" ref="filterOption">
							<span class="filter-option-title" tabindex="0" @click="selectFilter('genre')" v-on:keyup.enter="selectFilter('genre')">
								Genre
								<svg class="filter-arrow" width="10px" height="7px" viewBox="0 0 10 7" xmlns="http://www.w3.org/2000/svg">
									<path d="M4.47,6.24L0.22,1.99c-0.29-0.29-0.29-0.77,0-1.06l0.71-0.71c0.29-0.29,0.77-0.29,1.06,0L5,3.23l3.01-3.01 c0.29-0.29,0.77-0.29,1.06,0l0.71,0.71c0.29,0.29,0.29,0.77,0,1.06L5.53,6.24C5.24,6.53,4.77,6.53,4.47,6.24L4.47,6.24z">
								</svg>
							</span>
							<div class="filter-option-menu">
								<div class="filter-field" v-for="(genre, index) in allGenres">
									<input type="checkbox" :id="'genre-' + index" :value="genre" v-model="genreFilter">
									<label :for="'genre-' + index">{{ genre }}</label>
								</div>
							</div> <!-- /filter-option-menu -->
						</div> <!-- /filter-option -->

						<div class="filter-option" :class="{ active: activeFilter === 'rating', 'has-selections' : ratingFilter.length > 0 }" ref="filterOption">
							<span class="filter-option-title" tabindex="0" @click="selectFilter('rating')" v-on:keyup.enter="selectFilter('rating')">
								Rating
								<svg class="filter-arrow" width="10px" height="7px" viewBox="0 0 10 7" xmlns="http://www.w3.org/2000/svg">
									<path d="M4.47,6.24L0.22,1.99c-0.29-0.29-0.29-0.77,0-1.06l0.71-0.71c0.29-0.29,0.77-0.29,1.06,0L5,3.23l3.01-3.01 c0.29-0.29,0.77-0.29,1.06,0l0.71,0.71c0.29,0.29,0.29,0.77,0,1.06L5.53,6.24C5.24,6.53,4.77,6.53,4.47,6.24L4.47,6.24z"/>
								</svg>
							</span>
							<div class="filter-option-menu">
								<div class="filter-field" v-for="(rating, index) in allRatings">
									<input type="checkbox" :id="'rating-' + index" :value="rating" v-model="ratingFilter">
									<label :for="'rating-' + index">{{ rating }}</label>
								</div>
							</div> <!-- /filter-option-menu -->
						</div> <!-- /filter-option -->

						<div class="filter-option" :class="{ active: activeFilter === 'year', 'has-selections' : startYear || endYear }" ref="filterOption">
							<span class="filter-option-title" tabindex="0" @click="selectFilter('year')" v-on:keyup.enter="selectFilter('year')">
								Year
								<svg class="filter-arrow" width="10px" height="7px" viewBox="0 0 10 7" xmlns="http://www.w3.org/2000/svg">
									<path d="M4.47,6.24L0.22,1.99c-0.29-0.29-0.29-0.77,0-1.06l0.71-0.71c0.29-0.29,0.77-0.29,1.06,0L5,3.23l3.01-3.01 c0.29-0.29,0.77-0.29,1.06,0l0.71,0.71c0.29,0.29,0.29,0.77,0,1.06L5.53,6.24C5.24,6.53,4.77,6.53,4.47,6.24L4.47,6.24z">
								</svg>
							</span>
							<div class="filter-option-menu">
								<div class="filter-field year-range">
									<input type="number" :min="minYear" :max="maxYear" :placeholder="minYear" v-model.lazy="startYear" @change="validateMinYear()">
									to
									<input type="number" :min="minYear" :max="maxYear" :placeholder="maxYear" v-model.lazy="endYear" @change="validateMaxYear()">
								</div>
							</div> <!-- /filter-option-menu -->
						</div> <!-- /filter-option -->
					</template>

					<div class="filter-option" v-if="!screenPass">
						<button class="filter-random-btn" @click="selectRandom()">
							<svg class="random-icon" width="18px" height="16px" viewBox="0 0 36 32" xmlns="http://www.w3.org/2000/svg">
								<path d="M10.5,10.44l1.82,2.8l2.38-3.67l-0.85-1.31C12.28,5.83,8.9,4,6,4H0v4h6C7.53,8,9.67,9.16,10.5,10.44z" />
								<path style="opacity: 0.75;" d="M27,8h3v4l6-6l-6-6v4h-3c-2.9,0-6.28,1.83-7.86,4.26L10.5,21.56C9.67,22.83,7.53,24,6,24H0v4h6c2.9,0,6.28-1.83,7.86-4.26 l8.64-13.29C23.33,9.16,25.47,8,27,8z" />
								<path d="M30,24h-3c-1.53,0-3.67-1.16-4.5-2.44l-1.82-2.8l-2.39,3.67l0.85,1.31C20.72,26.17,24.1,28,27,28h3v4l6-6l-6-6V24z" />
							</svg>
							Surprise Me
						</button>
					</div> <!-- /filter-option -->

					<div class="filter-option">
						<button class="reset-btn" @click="reset()">
							<svg class="reset-icon" width="18px" height="18px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
								<path style="opacity: 0.5;" d="M8.11,8.11C10.64,5.57,14.14,4,18,4c4.27,0,8.23,1.95,10.85,5.15L24,14h12V2l-4.31,4.31C28.32,2.37,23.35,0,18,0 C13.04,0,8.54,2.02,5.28,5.28C2.92,7.64,1.22,10.63,0.46,14h4.11C5.24,11.73,6.47,9.74,8.11,8.11z" />
								<path d="M27.89,27.89C25.36,30.43,21.86,32,18,32c-4.27,0-8.23-1.95-10.85-5.15L12,22H0v12l4.31-4.31C7.68,33.63,12.65,36,18,36 c4.96,0,9.46-2.02,12.72-5.28c2.35-2.36,4.05-5.36,4.81-8.72h-4.13C30.74,24.25,29.52,26.27,27.89,27.89z" />
							</svg>
							Reset
						</button>
					</div> <!-- /filter-option -->

				</div> <!-- /filter-panel -->
			</div> <!-- /filters -->

			<div class="movies" :class="{ 'card-expanded': activeCard != null }">
				<div v-for="(movie, index) in movies" :key="index" :class="{ active: index === activeCard }" class="movie-card" tabindex="0" :title="movie.gsx$movietitle.$t" @click="selectItem(index)" v-on:keyup.enter="selectItem(index)" ref="movieCard">
					<span class="movie-card-title-preload">{{ movie.gsx$movietitle.$t }}</span>
					<img v-lazy="movie.gsx$image.$t" :alt="movie.gsx$movietitle.$t" class="movie-card-img">
					<div class="movie-card-overlay">
						<div class="movie-card-content">
							<span class="movie-card-title">{{ movie.gsx$movietitle.$t }}</span>
							<span class="movie-card-rating" title="Rating">{{ movie.gsx$rating.$t }}</span>
							<span class="movie-card-year" title="Release Year">{{ movie.gsx$year.$t }}</span>
							<dl class="movie-card-watch" v-if="!screenPass">
								<template v-if="movie.gsx$vudu.$t">
									<dt>Vudu</dt>
									<dd>{{ movie.gsx$vudu.$t }}</dd>
								</template>

								<template v-if="movie.gsx$googleplay.$t">
									<dt>Google Play</dt>
									<dd>{{ movie.gsx$googleplay.$t }}</dd>
								</template>

								<template v-if="movie.gsx$disc.$t">
									<dt>Disc</dt>
									<dd>{{ movie.gsx$disc.$t }}</dd>
								</template>
							</dl>
							<div class="screen-pass-form" v-if="screenPass" v-on:click.stop v-on:keyup.enter.stop>
								<template v-if="screenPassStatus == 'error'">Sorry, something went wrong.</template>
								<form @submit.prevent="submitScreenPass(movie.gsx$movietitle.$t, movie.gsx$year.$t)" v-if="screenPassAvailable">
									<input type="text" placeholder="Your name or email" v-model="screenPassUser" title="Enter your full name, profile, or email address so we know where to send the Screen Pass!" ref="email" required>
									<button type="submit" :disabled="screenPassStatus == 'processing'">
										<span class="btn-title">Request Screen Pass</span>
										<span class="loader"></span>
									</button>
								</form>
								<!-- <template v-if="!screenPassAvailable && screenPassStatus != 'success'">Please check back next month for more Screen Passes.</template> -->
								<template v-if="screenPassStatus == 'success'">Thank - we'll send you a link for your movie soon!</template>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<div class="request-form" :class="{ active: requestFormActive }" v-if="!screenPass">
				<button type="button" class="request-form-header" @click="toggleRequestForm">
					<svg class="request-icon" width="18px" height="18px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
						<path d="M18,0C8.06,0,0,8.06,0,18c0,4.97,2.01,9.47,5.27,12.73L0,36h18c9.94,0,18-8.06,18-18C36,8.06,27.94,0,18,0z M12,20 c-1.1,0-2-0.9-2-2s0.9-2,2-2c1.1,0,2,0.9,2,2S13.1,20,12,20z M18,20c-1.1,0-2-0.9-2-2s0.9-2,2-2c1.1,0,2,0.9,2,2S19.1,20,18,20z M24,20c-1.1,0-2-0.9-2-2s0.9-2,2-2c1.1,0,2,0.9,2,2S25.1,20,24,20z"/>
					</svg>
					Request a Movie
				</button>
				<form @submit.prevent="submitRequest">
					<p class="success-msg" v-if="requestStatus == 'success'">
						<svg class="success-icon" width="20px" height="20px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
							<path d="M18,0C8.08,0,0,8.08,0,18s8.08,18,18,18c9.92,0,18-8.08,18-18S27.92,0,18,0z M18,32c-7.72,0-14-6.28-14-14S10.28,4,18,4 c7.72,0,14,6.28,14,14S25.72,32,18,32z"/>
							<polygon points="16,19.17 13.41,16.59 10.59,19.41 16,24.83 25.41,15.41 22.59,12.59"/>
						</svg>
						Sent successfully!
					</p>
					<p class="error-msg" v-if="requestStatus == 'error'">
						<svg class="error-icon" width="20px" height="20px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
							<path d="M18,0C8.08,0,0,8.08,0,18s8.08,18,18,18c9.92,0,18-8.08,18-18S27.92,0,18,0z M18,32c-7.72,0-14-6.28-14-14S10.28,4,18,4 c7.72,0,14,6.28,14,14S25.72,32,18,32z"/>
							<polygon points="24.36,14.46 21.54,11.64 18,15.17 14.46,11.64 11.64,14.46 15.17,18 11.64,21.54 14.46,24.36 18,20.83 21.54,24.36 24.36,21.54 20.83,18"/>
						</svg>
						Sorry, something went wrong.
					</p>
					<input type="text" placeholder="First Name" v-model="requestName" ref="requestName" required>
					<input type="text" placeholder="Movie Title & Year" v-model="requestTitle" ref="requestTitle" required>
					<button class="request-form-btn" type="submit" :disabled="requestStatus == 'processing'">
						<span class="btn-title">Request</span>
						<span class="loader"></span>
					</button>
				</form>
			</div> <!-- /request-form -->
		</template>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios@0.19.2/dist/axios.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue-router@3.3.2/dist/vue-router.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue-lazyload@1.3.3/vue-lazyload.min.js"></script>
	<script src="assets/main.min.js"></script>
</body>

</html>